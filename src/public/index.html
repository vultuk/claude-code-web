<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Code Web Interface</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/xterm@5.3.0/lib/xterm.js"></script>
    <script src="https://unpkg.com/xterm-addon-fit@0.8.0/lib/xterm-addon-fit.js"></script>
    <script src="https://unpkg.com/xterm-addon-web-links@0.9.0/lib/xterm-addon-web-links.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/xterm@5.3.0/css/xterm.css" />
</head>
<body>
    <div id="app">
        <header class="header">
            <button class="hamburger-btn" id="hamburgerBtn">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
            <div class="header-content">
                <h1 class="desktop-only">ü§ñ Claude Code Web Interface</h1>
                <div class="header-info">
                    <span class="status" id="status">Connecting...</span>
                    <span class="working-dir" id="workingDir"></span>
                </div>
            </div>
            <div class="header-controls desktop-only">
                <div class="session-dropdown">
                    <button id="sessionBtn" class="btn btn-secondary session-btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
                            <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
                        </svg>
                        <span id="sessionBtnText">Sessions</span>
                        <svg class="dropdown-arrow" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"/>
                        </svg>
                    </button>
                    <div class="session-dropdown-menu" id="sessionDropdown">
                        <div class="session-dropdown-header">
                            <h3>Claude Sessions</h3>
                            <button class="btn-icon" id="refreshSessionsBtn" title="Refresh sessions">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="23 4 23 10 17 10"/>
                                    <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
                                </svg>
                            </button>
                        </div>
                        <div class="session-list" id="sessionList">
                            <!-- Sessions will be dynamically added here -->
                        </div>
                        <div class="session-dropdown-footer">
                            <button class="btn btn-primary btn-small" id="newSessionBtn">New Session</button>
                        </div>
                    </div>
                </div>
                <button id="closeSessionBtn" class="btn btn-danger" style="display: none;">Close Session</button>
                <button id="reconnectBtn" class="btn btn-secondary" disabled>Reconnect</button>
                <button id="clearBtn" class="btn btn-secondary">Clear</button>
                <button id="settingsBtn" class="btn btn-secondary">Settings</button>
            </div>
        </header>

        <div class="mobile-menu" id="mobileMenu">
            <div class="mobile-menu-header">
                <h2>ü§ñ Claude Code</h2>
                <button class="close-menu-btn" id="closeMenuBtn">&times;</button>
            </div>
            <div class="mobile-menu-content">
                <button id="sessionsBtnMobile" class="mobile-menu-btn">Sessions</button>
                <button id="closeSessionBtnMobile" class="mobile-menu-btn btn-danger" style="display: none;">Close Session</button>
                <button id="reconnectBtnMobile" class="mobile-menu-btn" disabled>Reconnect</button>
                <button id="clearBtnMobile" class="mobile-menu-btn">Clear Terminal</button>
                <button id="settingsBtnMobile" class="mobile-menu-btn">Settings</button>
            </div>
        </div>

        <main class="main">
            <div class="terminal-container">
                <div id="terminal"></div>
                <div class="terminal-overlay" id="overlay">
                    <div class="overlay-content">
                        <div class="loading-spinner" id="loadingSpinner">
                            <div class="spinner"></div>
                            <p>Connecting to Claude Code...</p>
                        </div>
                        <div class="start-prompt" id="startPrompt" style="display: none;">
                            <h2>Welcome to Claude Code Web Interface</h2>
                            <p>Click the button below to start a new Claude Code session</p>
                            <div class="start-buttons">
                                <button id="startBtn" class="btn btn-primary">Start Claude Code</button>
                                <button id="dangerousSkipBtn" class="btn btn-danger-skip" title="Dangerously skip permissions (‚ö†Ô∏è Use with caution)">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                                        <line x1="12" y1="9" x2="12" y2="13"/>
                                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="error-message" id="errorMessage" style="display: none;">
                            <h3>Connection Error</h3>
                            <p id="errorText"></p>
                            <button id="retryBtn" class="btn btn-primary">Retry</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <div class="settings-modal" id="settingsModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Settings</h2>
                    <button class="close-btn" id="closeSettingsBtn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="setting-group">
                        <label for="fontSize">Font Size:</label>
                        <input type="range" id="fontSize" min="10" max="24" value="14">
                        <span id="fontSizeValue">14px</span>
                    </div>
                    <div class="setting-group">
                        <label for="theme">Theme:</label>
                        <select id="theme">
                            <option value="dark">Dark</option>
                            <option value="light">Light</option>
                        </select>
                    </div>
                    <div class="setting-group">
                        <label for="cursorBlink">Cursor Blink:</label>
                        <input type="checkbox" id="cursorBlink" checked>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" id="saveSettingsBtn">Save Settings</button>
                </div>
            </div>
        </div>

        <div class="plan-modal" id="planModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üìã Claude's Plan</h2>
                    <button class="close-btn" id="closePlanBtn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="plan-status" id="planStatus">
                        <span class="plan-status-indicator"></span>
                        <span class="plan-status-text">Plan Mode Active</span>
                    </div>
                    <div class="plan-content" id="planContent">
                        <!-- Plan will be inserted here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-success" id="acceptPlanBtn">‚úÖ Accept Plan</button>
                    <button class="btn btn-danger" id="rejectPlanBtn">‚ùå Reject Plan</button>
                </div>
            </div>
        </div>

        <div class="session-modal" id="newSessionModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Create New Session</h2>
                    <button class="close-btn" id="closeNewSessionBtn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="sessionName">Session Name:</label>
                        <input type="text" id="sessionName" placeholder="Enter session name (optional)">
                    </div>
                    <div class="form-group">
                        <label for="sessionWorkingDir">Working Directory:</label>
                        <input type="text" id="sessionWorkingDir" placeholder="Leave empty to use current directory">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancelNewSessionBtn">Cancel</button>
                    <button class="btn btn-primary" id="createSessionBtn">Create Session</button>
                </div>
            </div>
        </div>

        <div class="folder-browser-modal" id="folderBrowserModal">
            <div class="modal-content folder-browser-content">
                <div class="modal-header">
                    <h2>Select Working Directory</h2>
                </div>
                <div class="folder-browser-body">
                    <div class="folder-path-bar">
                        <button class="btn-icon" id="folderUpBtn" title="Go to parent directory">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M19 12H5M12 19l-7-7 7-7"/>
                            </svg>
                        </button>
                        <button class="btn-icon" id="folderHomeBtn" title="Go to home directory">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                            </svg>
                        </button>
                        <input type="text" class="folder-path-input" id="currentPathInput" readonly>
                        <button class="btn-icon" id="createFolderBtn" title="Create new folder">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                                <line x1="12" y1="11" x2="12" y2="17"/>
                                <line x1="9" y1="14" x2="15" y2="14"/>
                            </svg>
                        </button>
                    </div>
                    <div class="folder-create-bar" id="folderCreateBar" style="display: none;">
                        <input type="text" class="folder-name-input" id="newFolderNameInput" placeholder="Enter folder name...">
                        <button class="btn btn-primary btn-small" id="confirmCreateFolderBtn">Create</button>
                        <button class="btn btn-secondary btn-small" id="cancelCreateFolderBtn">Cancel</button>
                    </div>
                    <div class="folder-list-container">
                        <div class="folder-list" id="folderList">
                            <!-- Folders will be dynamically added here -->
                        </div>
                    </div>
                    <div class="folder-browser-footer">
                        <label class="checkbox-label">
                            <input type="checkbox" id="showHiddenFolders">
                            Show hidden folders
                        </label>
                        <div class="folder-browser-buttons">
                            <button class="btn btn-secondary" id="cancelFolderBtn">Cancel</button>
                            <button class="btn btn-primary" id="selectFolderBtn">Select This Folder</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Sessions Modal -->
    <div class="session-modal" id="mobileSessionsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Sessions</h2>
                <button class="modal-close" id="closeMobileSessionsModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="mobileSessionList" class="session-list">
                    <!-- Sessions will be dynamically added here -->
                </div>
                <button class="btn btn-primary" id="newSessionBtnMobile" style="width: 100%; margin-top: 10px;">New Session</button>
            </div>
        </div>
    </div>

    <script src="plan-detector.js"></script>
    <script src="app.js"></script>
</body>
</html>